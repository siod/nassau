<!DOCTYPE html>
<html >
<head>
	<title>Nassau Movies</title>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
	<link rel="shortcut icon" href="${request.static_url('nassau:static/favicon.ico')}" />
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
	<link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
	<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <style>
        body {
            background-color: #313030;
        }
        .poster {
            width: 187px;
            height: 275px;
            margin-left:10px;
            margin-right:10px;
            margin-bottom:15px;
            margin-top:15px;
            float:left;
            color: #FFFFFF;
        }
        .poster img {
            border:1px solid #000;
            border-radius:6px;
            overflow:hidden;
        }
        .poster a {
            display: inline-block;
            cursor: pointer;

        }
        .poster-downloaded img {
            border:1px solid #5cb85c;
        }

    </style>
</head>
<body>
	<div class="container">
        <div tal:repeat="movie movies" tal:attributes="class 'poster poster-downloaded' if movie.downloaded else 'poster'">
            <a href="${request.application_url}/movie/${movie.id}/download">
                <img tal:condition="python:len(movie.poster_path)  > 0" src="${baseURL}${posterSize}${movie.poster_path}" alt="${movie.title}" title="${movie.title}" data-id="${movie.id}" />
                <img tal:condition="python:len(movie.poster_path)  == 0" src="${noPoster}" alt="${movie.title}" title="${movie.title}" />
            </a>
            <!--!<p>${movie.title} ${movie.release_date}</p>-->
        </div>
	</div>
	<script type="text/javascript">
        $(document).ready(function() {
                $('.poster a').click(function() {
                    var thisPoster = this;
                    $.post($(this).attr('href'))
                        .done(function(data) {
                            console.log("download started");
                            $(thisPoster).parent().addClass('poster-downloaded');
                        })
                        .fail(function(data) {
                            console.log("failed");
                            console.log(data);
                        });

                    return false;
                });
        });
    </script>
</body>
</html>
